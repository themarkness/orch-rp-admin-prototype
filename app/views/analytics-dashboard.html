{% extends "layouts/main.html" %}
{% from "components/sidebar.njk" import sidebar %}
{% from "govuk/components/select/macro.njk" import govukSelect %}
{% from "govuk/components/summary-list/macro.njk" import govukSummaryList %}
{% from "govuk/components/table/macro.njk" import govukTable %}

{% block pageTitle %}
  Analytics – {{ serviceName }} – GOV.UK Prototype Kit
{% endblock %}

{% block content %}

<style>
  .metric-card {
    background: #1d70b8;
    color: white;
    padding: 30px 30px 20px 30px;
    margin-bottom: 5px;
    font-family: "GDS Transport", arial, sans-serif;
    min-height: 150px;
  }
  .metric-number {
    font-size: 48px;
    font-weight: 700;
    line-height: 1.09375;
    display: inline-block;
    margin-bottom: 10px;
    font-family: "GDS Transport", arial, sans-serif;
  }
  .metric-label {
    font-size: 19px;
    font-weight: 400;
    display: block;
    border-bottom: 1px solid white;
    padding-bottom: 5px;
    font-family: "GDS Transport", arial, sans-serif;
  }
  .metric-comparison {
    font-size: 48px;
    font-weight: 700;
    display: inline-block;
    margin-left: 15px;
    vertical-align: baseline;
    font-family: "GDS Transport", arial, sans-serif;
  }
  .metric-comparison.positive {
    color: #00703c;
  }
  .metric-comparison.negative {
    color: #d4351c;
  }
  .hero-metric {
    min-height: auto;
    padding: 40px 30px 30px 30px;
  }
  .metric-description {
    color: white;
    font-size: 19px;
    font-weight: 400;
    margin-top: 15px;
    margin-bottom: 0;
    font-family: "GDS Transport", arial, sans-serif;
  }
  .context-metric {
    background: #f3f2f1;
    padding: 25px 20px;
    font-family: "GDS Transport", arial, sans-serif;
  }
  .context-number {
    font-size: 36px;
    font-weight: 700;
    display: block;
    margin-bottom: 10px;
    color: #0b0c0c;
    font-family: "GDS Transport", arial, sans-serif;
  }
  .context-label {
    font-size: 19px;
    font-weight: 400;
    display: block;
    color: #0b0c0c;
    font-family: "GDS Transport", arial, sans-serif;
  }
  .metric-status {
    background: #00703c;
    color: white;
    padding: 15px 20px;
    font-size: 19px;
    font-weight: 400;
    font-family: "GDS Transport", arial, sans-serif;
  }
  .metric-status.warning {
    background: #d4351c;
  }
  .stat-change {
    font-size: 19px;
    margin-top: 10px;
    display: block;
  }
  .percentage-bar {
    background: #f3f2f1;
    height: 40px;
    margin: 15px 0;
    position: relative;
    border-radius: 0;
  }
  .percentage-bar-fill {
    background: #1d70b8;
    height: 100%;
    display: flex;
    align-items: center;
    padding-left: 15px;
    color: white;
    font-weight: bold;
  }
</style>

<h1 class="govuk-heading-m ">Manage {{ serviceName }}</h1>

<hr class="govuk-section-break govuk-section-break--visible">

<div class="govuk-grid-row">
  {{ sidebar('dashboard') }}
  <div class="govuk-grid-column-three-quarters">

    <h2 class="govuk-heading-l govuk-!-margin-top-6"">Analytics</h2>

    {{ govukSelect({
      id: "time-period",
      name: "time-period",
      label: {
        text: "Time period",
        classes: "govuk-label--m"
      },
      items: [
        {
          value: "24hours",
          text: "Last 24 hours"
        },
        {
          value: "7days",
          text: "Last 7 days",
          selected: true
        },
        {
          value: "30days",
          text: "Last 30 days"
        },
        {
          value: "90days",
          text: "Last 90 days"
        }
      ]
    }) }}

    <h3 class="govuk-heading-m govuk-!-margin-top-6">In the last 7 days</h3>

    <div class="govuk-grid-row">
      <div class="govuk-grid-column-full">
        <div class="metric-card hero-metric">
          <span class="metric-number">82%</span>
          <span class="metric-comparison positive">↑ 2.5%</span>
          <span class="metric-label">journey completion rate</span>
          <p class="metric-description">8,200 users completed their journey and returned to your service</p>
        </div>
      </div>
    </div>

    <div class="govuk-grid-row govuk-!-margin-top-4">
      <div class="govuk-grid-column-one-half">
        <div class="context-metric">
          <span class="context-number">10,000</span>
          <span class="context-label">journeys started</span>
        </div>
      </div>
      <div class="govuk-grid-column-one-half">
        <div class="context-metric">
          <span class="context-number">23.5%</span>
          <span class="context-label">of users retried verification</span>
        </div>
      </div>
    </div>

    <hr class="govuk-section-break govuk-section-break--xl govuk-section-break--visible">

    <h3 class="govuk-heading-m">Journey completion funnel</h3>
    <p class="govuk-body">How users progress through the verification journey.</p>

    {{ govukSummaryList({
      rows: [
        {
          key: {
            text: "Journey started"
          },
          value: {
            html: '10,000 <span class="govuk-!-font-weight-regular">(100%)</span>'
          }
        },
        {
          key: {
            text: "Document submitted"
          },
          value: {
            html: '8,750 <span class="govuk-!-font-weight-regular">(87.5%)</span>'
          }
        },
        {
          key: {
            text: "Verification completed"
          },
          value: {
            html: '8,500 <span class="govuk-!-font-weight-regular">(85%)</span>'
          }
        },
        {
          key: {
            text: "Returned to service"
          },
          value: {
            html: '8,200 <span class="govuk-!-font-weight-regular">(82%)</span>'
          }
        }
      ]
    }) }}

    <div class="govuk-inset-text">
      18% of users who started the journey did not complete it and return to your service.
    </div>

    <hr class="govuk-section-break govuk-section-break--xl govuk-section-break--visible">

    <h3 class="govuk-heading-m">Failure reasons</h3>
    <p class="govuk-body">Breakdown of why verifications failed in the selected period.</p>

    {{ govukTable({
      firstCellIsHeader: false,
      head: [
        {
          text: "Reason"
        },
        {
          text: "Count",
          format: "numeric"
        },
        {
          text: "Percentage",
          format: "numeric"
        }
      ],
      rows: [
        [
          {
            text: "Document scan failed"
          },
          {
            text: "450",
            format: "numeric"
          },
          {
            html: '<div class="percentage-bar"><div class="percentage-bar-fill" style="width: 30%">30%</div></div>',
            format: "numeric"
          }
        ],
        [
          {
            text: "User abandoned journey"
          },
          {
            text: "375",
            format: "numeric"
          },
          {
            html: '<div class="percentage-bar"><div class="percentage-bar-fill" style="width: 25%">25%</div></div>',
            format: "numeric"
          }
        ],
        [
          {
            text: "Session timeout"
          },
          {
            text: "300",
            format: "numeric"
          },
          {
            html: '<div class="percentage-bar"><div class="percentage-bar-fill" style="width: 20%">20%</div></div>',
            format: "numeric"
          }
        ],
        [
          {
            text: "Face match failed"
          },
          {
            text: "225",
            format: "numeric"
          },
          {
            html: '<div class="percentage-bar"><div class="percentage-bar-fill" style="width: 15%">15%</div></div>',
            format: "numeric"
          }
        ],
        [
          {
            text: "Invalid document"
          },
          {
            text: "150",
            format: "numeric"
          },
          {
            html: '<div class="percentage-bar"><div class="percentage-bar-fill" style="width: 10%">10%</div></div>',
            format: "numeric"
          }
        ]
      ]
    }) }}

    <hr class="govuk-section-break govuk-section-break--xl govuk-section-break--visible">

    <h3 class="govuk-heading-m">Daily performance</h3>
    <p class="govuk-body">Success and failure rates for each day in the selected period.</p>

    {{ govukTable({
      firstCellIsHeader: true,
      head: [
        {
          text: "Day"
        },
        {
          text: "Total",
          format: "numeric"
        },
        {
          text: "Successful",
          format: "numeric"
        },
        {
          text: "Failed",
          format: "numeric"
        },
        {
          text: "Success rate",
          format: "numeric"
        }
      ],
      rows: [
        [
          {
            text: "Monday"
          },
          {
            text: "1,450",
            format: "numeric"
          },
          {
            text: "1,233",
            format: "numeric"
          },
          {
            text: "217",
            format: "numeric"
          },
          {
            text: "85.0%",
            format: "numeric"
          }
        ],
        [
          {
            text: "Tuesday"
          },
          {
            text: "1,520",
            format: "numeric"
          },
          {
            text: "1,292",
            format: "numeric"
          },
          {
            text: "228",
            format: "numeric"
          },
          {
            text: "85.0%",
            format: "numeric"
          }
        ],
        [
          {
            text: "Wednesday"
          },
          {
            text: "1,380",
            format: "numeric"
          },
          {
            text: "1,179",
            format: "numeric"
          },
          {
            text: "201",
            format: "numeric"
          },
          {
            text: "85.4%",
            format: "numeric"
          }
        ],
        [
          {
            text: "Thursday"
          },
          {
            text: "1,470",
            format: "numeric"
          },
          {
            text: "1,243",
            format: "numeric"
          },
          {
            text: "227",
            format: "numeric"
          },
          {
            text: "84.6%",
            format: "numeric"
          }
        ],
        [
          {
            text: "Friday"
          },
          {
            text: "1,590",
            format: "numeric"
          },
          {
            text: "1,351",
            format: "numeric"
          },
          {
            text: "239",
            format: "numeric"
          },
          {
            text: "85.0%",
            format: "numeric"
          }
        ],
        [
          {
            text: "Saturday"
          },
          {
            text: "1,210",
            format: "numeric"
          },
          {
            text: "1,029",
            format: "numeric"
          },
          {
            text: "181",
            format: "numeric"
          },
          {
            text: "85.0%",
            format: "numeric"
          }
        ],
        [
          {
            text: "Sunday"
          },
          {
            text: "1,380",
            format: "numeric"
          },
          {
            text: "1,173",
            format: "numeric"
          },
          {
            text: "207",
            format: "numeric"
          },
          {
            text: "85.0%",
            format: "numeric"
          }
        ]
      ]
    }) }}

  </div>
</div>

{% endblock %}
